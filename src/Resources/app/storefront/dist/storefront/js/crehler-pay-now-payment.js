"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["crehler-pay-now-payment"],{5581:(t,e,i)=>{var n,o,s,a=i(6285),r=i(1966),c=i(3206);class h extends a.Z{init(){this._form=c.Z.querySelector(document,this.options.formSelector),this.formAutoSubmitInstance=PluginManager.getPluginInstanceFromElement(this._form,"FormAutoSubmit"),this._banks=c.Z.querySelectorAll(this.el,this.options.bankLabelSelector),this._paymentInputPaymentInput=c.Z.querySelector(document,`[name="${this.options.paymentMethodInputName}"][value="${this.options.paymentId}"]`),this._registerEvents()}_registerEvents(){r.Z.iterate(this._banks,(t=>{t.addEventListener("click",this._onBankClick.bind(this))}))}_onBankClick(t){this.formAutoSubmitInstance.options.changeTriggerSelectors.push(this.options.changeTriggerSelector);const e=this.el.querySelector("."+this.options.itemActiveClass);t.stopPropagation(),this._paymentInputPaymentInput.checked=!0,e&&e.classList.remove(this.options.itemActiveClass),t.target.parentElement.classList.add(this.options.itemActiveClass)}}n=h,s={bankInputName:"payNowBank",bankLabelSelector:".paynow--bank-input:not(.disabled-method)",formSelector:"#changePaymentForm",paymentMethodInputName:"paymentMethodId",itemActiveClass:"is--active",paymentId:"",changeTriggerSelector:".paynow--bank-input"},(o=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(o="options"))in n?Object.defineProperty(n,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[o]=s;var l=i(8254);class u extends a.Z{init(){this._errors=[],this._client=new l.Z,this.checksCount=0;this._getConfig(),this.totalChecksCount=Math.floor(0),this._checkOrderPayment(),this._checkPaymentStateInterval()}_getConfig(){const t=this.el.dataset.paynowPaymentCheckOptions,e=JSON.parse(t);this.waitingTime=e.waitingTime,this.options.checkUrl=e.checkUrl,this.options.transactionId=e.transactionId,this.options.successUrl=e.successUrl,this.options.failUrl=e.failUrl}_checkPaymentStateInterval(){this.loopInterval=setInterval(this._loop.bind(this),1e4)}_loop(){this._checkOrderPayment(),this.checksCount>=this.totalChecksCount&&(clearInterval(this.loopInterval),this._changeButtonText(this.options.waitingFailText),this._changeLocation(this.options.failUrl))}_checkOrderPayment(){this.checksCount++,this._client.post(this.options.checkUrl,JSON.stringify({transactionId:this.options.transactionId}),this._showPaymentState.bind(this))}_showPaymentState(t){let e=JSON.parse(t);console.log(e),e.success?(this._changeButtonText(this.options.waitingSuccessText),this._changeLocation(this.options.successUrl)):e.waiting||(this._changeButtonText(this.options.waitingFailText),this._changeLocation(this.options.failUrl))}_changeButtonText(t){this.el.querySelector("[data-info-text]").innerText=t}_changeLocation(t){setTimeout((()=>{window.location.href=t}),1500)}}!function(t,e,i){(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(u,"options",{transactionId:"",successUrl:"",failUrl:"",checkUrl:"",waitingSuccessText:"",waitingFailText:""});const p=window.PluginManager;p.register("PayNowPaymentMethods",h,"[data-pay-now-payment-methods]"),p.register("PayNowPaymentCheckPlugin",u,"[data-paynow-payment-check]")}},t=>{t.O(0,["vendor-node","vendor-shared"],(()=>{return e=5581,t(t.s=e);var e}));t.O()}]);